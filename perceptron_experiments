import numpy as np
import matplotlib.pyplot as plt
from src.perceptron import Perceptron
from src.utils import load_data, split_data
from sklearn.metrics import confusion_matrix, accuracy_score

# Load and split the data
X, y = load_data('data/diabetes.csv')
X_train, X_test, y_train, y_test = split_data(X, y)

# Initialize the Perceptron model
model = Perceptron(learning_rate=0.01, epochs=1000)

# Train the model
model.fit(X_train, y_train)

# Make predictions on the test set
y_pred = model.predict(X_test)

# Evaluate the model
accuracy = accuracy_score(y_test, y_pred)
conf_matrix = confusion_matrix(y_test, y_pred)

print(f"Test Accuracy: {accuracy * 100:.2f}%")
print(f"Confusion Matrix:\n{conf_matrix}")

# Plot the confusion matrix
plt.figure(figsize=(5, 5))
plt.imshow(conf_matrix, cmap='Blues')
plt.title('Confusion Matrix')
plt.colorbar()
plt.show()
